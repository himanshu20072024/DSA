आरंभम् कार्यम्

परिभाषा: पूर्णाङ्कः उच्चतमः = १००
परिभाषा: वर्णपङ्क्तिः सञ्चयः[१००]
परिभाषा: पूर्णाङ्कः शीर्षम् = -१

क्रियाः स्थापय(वर्णः चिह्नम्)
    शीर्षम् = शीर्षम् + १
    सञ्चयः[शीर्षम्] = चिह्नम्
समाप्तम्

क्रियाः आनय() → वर्णः
    वर्णः लघुचिह्नम् = सञ्चयः[शीर्षम्]
    शीर्षम् = शीर्षम् - १
    प्रतिनिवर्तनम् लघुचिह्नम्
समाप्तम्

क्रियाः शिरः() → वर्णः
    प्रतिनिवर्तनम् सञ्चयः[शीर्षम्]
समाप्तम्

क्रियाः प्राथमिकता(वर्णः क्रिया) → पूर्णाङ्कः
    यदि क्रिया == '^' तर्हि प्रतिनिवर्तनम् ३
    यदि क्रिया == '*' अथवा '/' तर्हि प्रतिनिवर्तनम् २
    यदि क्रिया == '+' अथवा '-' तर्हि प्रतिनिवर्तनम् १
    अन्यथा प्रतिनिवर्तनम् ०
समाप्तम्

क्रियाः मध्यतः_पश्चात्(पङ्क्तिः मध्य, पङ्क्तिः पश्चात्)
    पूर्णाङ्कः i = ०, j = ०
    यावत् मध्य[i] != '\0' कुर्वन्तु
        वर्णः च = मध्य[i]
        यदि वर्णः च अल्फान्युमेरिकः अस्ति तर्हि
            पश्चात्[j] = च
            j = j + १
        अन्यथा यदि च == '(' तर्हि
            स्थापय(च)
        अन्यथा यदि च == ')' तर्हि
            यावत् शिरः() != '(' कुर्वन्तु
                पश्चात्[j] = आनय()
                j = j + १
            समाप्तम्
            आनय() // '(' त्यजतु
        अन्यथा
            यावत् शीर्षम् != -१ च प्राथमिकता(शिरः()) ≥ प्राथमिकता(च) कुर्वन्तु
                पश्चात्[j] = आनय()
                j = j + १
            समाप्तम्
            स्थापय(च)
        समाप्तम्
        i = i + १
    समाप्तम्

    यावत् शीर्षम् != -१ कुर्वन्तु
        पश्चात्[j] = आनय()
        j = j + १
    समाप्तम्

    पश्चात्[j] = '\0'
समाप्तम्

मुख्यकार्य()
    पङ्क्तिः मध्य[१००], पश्चात्[१००]
    लिखतु("मध्य रूप समीकरणं प्रविष्टं कुरुत:")
    पठतु(मध्य)
    मध्यतः_पश्चात्(मध्य, पश्चात्)
    लिखतु("पश्चात् रूप समीकरणम्: ", पश्चात्)
समाप्तम्
